<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diet Tracker - TheDietPlanner.com</title>
    <meta name="description" content="Track your nutrition and manage your diet with Indian foods database, export capabilities, and detailed analytics.">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="container">
                <div class="flex justify-between items-center">
                    <div class="logo">
                        <h1>Diet Tracker</h1>
                        <span class="subtitle">by TheDietPlanner.com</span>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn--outline btn--sm" id="backupBtn" aria-label="Backup data">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            </svg>
                            Backup
                        </button>
                        <button class="btn btn--outline btn--sm" id="profileBtn" aria-label="Open profile settings">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            </svg>
                            Profile
                        </button>
                        <button class="btn btn--outline btn--sm" id="themeToggle" aria-label="Toggle theme">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" id="themeIcon">
                                <path d="M7.5,2C5.71,3.15 4.5,5.18 4.5,7.5C4.5,9.82 5.71,11.85 7.53,13C4.46,13 2,10.54 2,7.5A5.5,5.5 0 0,1 7.5,2M19.07,3.5L20.5,4.93L4.93,20.5L3.5,19.07L19.07,3.5M12.89,5.93L11.41,5L9.97,6L10.39,4.3L9,3.24L10.75,3.12L11.33,1.47L12,3.1L13.73,3.13L12.38,4.26L12.89,5.93M9.59,9.54L8.43,8.81L7.31,9.59L7.65,8.27L6.56,7.44L7.92,7.35L8.37,6.06L8.88,7.33L10.24,7.36L9.19,8.23L9.59,9.54M19,13.5A5.5,5.5 0 0,1 13.5,19C12.28,19 11.15,18.6 10.24,17.93L17.93,10.24C18.6,11.15 19,12.28 19,13.5Z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs" role="tablist">
            <div class="container">
                <div class="tab-list">
                    <button class="tab-button active" role="tab" aria-selected="true" aria-controls="dailyTab" data-tab="daily">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                        </svg>
                        Daily View
                    </button>
                    <button class="tab-button" role="tab" aria-selected="false" aria-controls="weeklyTab" data-tab="weekly">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 10H3V8h18v8z"/>
                        </svg>
                        Weekly View
                    </button>
                    <button class="tab-button" role="tab" aria-selected="false" aria-controls="analyticsTab" data-tab="analytics">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M22 21H2v-2h20v2zm-9-4v-2H9c-1.1 0-2 .9-2 2v2h6zm4 0v-6h-4c-1.1 0-2 .9-2 2v6h6zm4 0V9h-4c-1.1 0-2 .9-2 2v8h6z"/>
                        </svg>
                        Analytics
                    </button>
                    <button class="tab-button" role="tab" aria-selected="false" aria-controls="exportTab" data-tab="export">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                        </svg>
                        Export
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Daily View Tab -->
                <div class="tab-content active" id="dailyTab" role="tabpanel" aria-labelledby="daily-tab">
                    <div class="daily-header">
                        <div class="date-selector">
                            <button id="prevDay" class="date-nav-btn" aria-label="Previous day">‹</button>
                            <label for="currentDate" class="sr-only">Select date</label>
                            <input type="date" id="currentDate" class="form-control date-input" aria-label="Current date">
                            <button id="nextDay" class="date-nav-btn" aria-label="Next day">›</button>
                        </div>
                        <button class="btn btn--primary" id="addEntryBtn" aria-label="Add new food entry">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            Add Food
                        </button>
                    </div>

                    <!-- Daily Summary Cards -->
                    <div class="summary-grid">
                        <div class="summary-card">
                            <h3>Calories</h3>
                            <div class="summary-value">
                                <span class="current" id="caloriesCurrent" aria-label="Current calories">0</span>
                                <span class="target">/ <span id="caloriesTarget">2000</span></span>
                            </div>
                            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                <div class="progress-fill" id="caloriesProgress"></div>
                            </div>
                        </div>

                        <div class="summary-card">
                            <h3>Protein</h3>
                            <div class="summary-value">
                                <span class="current" id="proteinCurrent">0</span>g
                                <span class="target">/ <span id="proteinTarget">150</span>g</span>
                            </div>
                            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                <div class="progress-fill" id="proteinProgress"></div>
                            </div>
                        </div>

                        <div class="summary-card">
                            <h3>Carbs</h3>
                            <div class="summary-value">
                                <span class="current" id="carbsCurrent">0</span>g
                                <span class="target">/ <span id="carbsTarget">250</span>g</span>
                            </div>
                            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                <div class="progress-fill" id="carbsProgress"></div>
                            </div>
                        </div>

                        <div class="summary-card">
                            <h3>Fat</h3>
                            <div class="summary-value">
                                <span class="current" id="fatCurrent">0</span>g
                                <span class="target">/ <span id="fatTarget">65</span>g</span>
                            </div>
                            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                <div class="progress-fill" id="fatProgress"></div>
                            </div>
                        </div>

                        <div class="summary-card">
                            <h3>Fiber</h3>
                            <div class="summary-value">
                                <span class="current" id="fiberCurrent">0</span>g
                                <span class="target">/ <span id="fiberTarget">25</span>g</span>
                            </div>
                            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                <div class="progress-fill" id="fiberProgress"></div>
                            </div>
                        </div>

                        <div class="summary-card water-card">
                            <h3>Water</h3>
                            <div class="summary-value">
                                <span class="current" id="waterCurrent">0</span>ml
                                <span class="target">/ <span id="waterTarget">2000</span>ml</span>
                            </div>
                            <div class="water-buttons">
                                <button class="water-btn" data-amount="250" aria-label="Add 250ml water">+250ml</button>
                                <button class="water-btn" data-amount="500" aria-label="Add 500ml water">+500ml</button>
                            </div>
                        </div>
                    </div>

                    <!-- Meal Sections -->
                    <div class="meals-container">
                        <div class="meal-section" data-meal="breakfast">
                            <h3 class="meal-title">
                                <span>🌅 Breakfast</span>
                                <span class="meal-calories">0 kcal</span>
                            </h3>
                            <div class="meal-entries" role="list"></div>
                        </div>

                        <div class="meal-section" data-meal="mid-morning">
                            <h3 class="meal-title">
                                <span>☕ Mid-Morning</span>
                                <span class="meal-calories">0 kcal</span>
                            </h3>
                            <div class="meal-entries" role="list"></div>
                        </div>

                        <div class="meal-section" data-meal="lunch">
                            <h3 class="meal-title">
                                <span>🍽️ Lunch</span>
                                <span class="meal-calories">0 kcal</span>
                            </h3>
                            <div class="meal-entries" role="list"></div>
                        </div>

                        <div class="meal-section" data-meal="snack">
                            <h3 class="meal-title">
                                <span>🍎 Snack</span>
                                <span class="meal-calories">0 kcal</span>
                            </h3>
                            <div class="meal-entries" role="list"></div>
                        </div>

                        <div class="meal-section" data-meal="dinner">
                            <h3 class="meal-title">
                                <span>🌙 Dinner</span>
                                <span class="meal-calories">0 kcal</span>
                            </h3>
                            <div class="meal-entries" role="list"></div>
                        </div>
                    </div>
                </div>

                <!-- Weekly View Tab -->
                <div class="tab-content" id="weeklyTab" role="tabpanel" aria-labelledby="weekly-tab">
                    <div class="weekly-header">
                        <div class="week-selector">
                            <button id="prevWeek" class="date-nav-btn" aria-label="Previous week">‹</button>
                            <span id="weekRange" role="status">Week of Aug 12 - Aug 18, 2025</span>
                            <button id="nextWeek" class="date-nav-btn" aria-label="Next week">›</button>
                        </div>
                    </div>
                    <div class="weekly-grid" id="weeklyGrid" role="grid">
                        <!-- Weekly grid will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Analytics Tab -->
                <div class="tab-content" id="analyticsTab" role="tabpanel" aria-labelledby="analytics-tab">
                    <div class="charts-container">
                        <div class="chart-section">
                            <h3>Calories Over Time (Last 7 Days)</h3>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="caloriesChart" role="img" aria-label="Calories over time chart"></canvas>
                            </div>
                        </div>

                        <div class="chart-section">
                            <h3>Macro Distribution (Today)</h3>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="macrosChart" role="img" aria-label="Macro distribution chart"></canvas>
                            </div>
                        </div>

                        <div class="chart-section">
                            <h3>Weekly Summary</h3>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="weeklyChart" role="img" aria-label="Weekly summary chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Export Tab -->
                <div class="tab-content" id="exportTab" role="tabpanel" aria-labelledby="export-tab">
                    <div class="export-section">
                        <h3>Export & Backup</h3>
                        <p class="export-description">Export your data, create backups, or get templates for external tools. <br><strong>All data stays local</strong> - no external servers involved.</p>
                        
                        <div class="export-options">
                            <div class="export-group">
                                <h4>Quick Exports</h4>
                                <div class="export-buttons">
                                    <button class="btn btn--primary export-btn" id="exportCSV">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                        </svg>
                                        CSV File
                                    </button>
                                    <button class="btn btn--primary export-btn" id="exportXLSX">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                        </svg>
                                        Excel File
                                    </button>
                                    <button class="btn btn--primary export-btn" id="exportPDF">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                        </svg>
                                        PDF Report
                                    </button>
                                </div>
                            </div>

                            <div class="export-group">
                                <h4>Data Management</h4>
                                <div class="export-buttons">
                                    <button class="btn btn--secondary" id="backupJSON">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M9,10H7V12H9V10M13,10H11V12H13V10M17,10H15V12H17V10M19,3A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H6V1H8V3H16V1H18V3H19Z"/>
                                        </svg>
                                        Backup JSON
                                    </button>
                                    <button class="btn btn--secondary" id="restoreJSON">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12,3A9,9 0 0,1 21,12H18A6,6 0 0,0 12,6V3M12,21A9,9 0 0,1 3,12H6A6,6 0 0,0 12,18V21M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M15.5,12L10.5,16L15.5,12L10.5,8L15.5,12Z"/>
                                        </svg>
                                        Restore JSON
                                    </button>
                                    <button class="btn btn--outline" id="importCSV">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                        </svg>
                                        Import CSV
                                    </button>
                                    <button class="btn btn--outline" id="clearData" style="color: var(--color-error);">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z"/>
                                        </svg>
                                        Clear All Data
                                    </button>
                                </div>
                            </div>

                            <div class="export-group">
                                <h4>Google Sheets Template</h4>
                                <p>Download a pre-formatted Excel template that you can upload to Google Sheets:</p>
                                <button class="btn btn--outline" id="getSheetsTemplate">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M19,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3M19,19H5V5H19V19M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5L13.96,12.29Z"/>
                                    </svg>
                                    Download Template
                                </button>
                            </div>
                        </div>

                        <div class="export-status" id="exportStatus" role="status" aria-live="polite"></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Add Entry Modal -->
        <div class="modal hidden" id="addEntryModal" role="dialog" aria-labelledby="modalTitle" aria-modal="true">
            <div class="modal-backdrop" aria-label="Close modal"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle">Add Food Entry</h2>
                    <button class="modal-close" aria-label="Close modal">×</button>
                </div>
                <div class="modal-body">
                    <form id="entryForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="entryDate" class="form-label">Date</label>
                                <input type="date" id="entryDate" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="entryMealTime" class="form-label">Meal</label>
                                <select id="entryMealTime" class="form-control" required>
                                    <option value="breakfast">🌅 Breakfast</option>
                                    <option value="mid-morning">☕ Mid-Morning</option>
                                    <option value="lunch">🍽️ Lunch</option>
                                    <option value="snack">🍎 Snack</option>
                                    <option value="dinner">🌙 Dinner</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="presetFoods" class="form-label">Quick Select (Indian Foods)</label>
                            <select id="presetFoods" class="form-control preset-select">
                                <option value="">Choose from Indian foods database...</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="entryFood" class="form-label">Food Name</label>
                            <input type="text" id="entryFood" class="form-control" placeholder="Enter food name" required>
                        </div>

                        <div class="form-group">
                            <label for="entryServing" class="form-label">Serving Size</label>
                            <input type="text" id="entryServing" class="form-control" placeholder="e.g., 1 cup, 100g, 2 pieces" required>
                        </div>

                        <div class="nutrition-grid">
                            <div class="form-group">
                                <label for="entryCalories" class="form-label">Calories</label>
                                <input type="number" id="entryCalories" class="form-control" placeholder="0" min="0" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label for="entryProtein" class="form-label">Protein (g)</label>
                                <input type="number" id="entryProtein" class="form-control" placeholder="0" min="0" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label for="entryCarbs" class="form-label">Carbs (g)</label>
                                <input type="number" id="entryCarbs" class="form-control" placeholder="0" min="0" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label for="entryFat" class="form-label">Fat (g)</label>
                                <input type="number" id="entryFat" class="form-control" placeholder="0" min="0" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label for="entryFiber" class="form-label">Fiber (g)</label>
                                <input type="number" id="entryFiber" class="form-control" placeholder="0" min="0" step="0.1">
                            </div>
                            <div class="form-group">
                                <label for="entryWater" class="form-label">Water (ml)</label>
                                <input type="number" id="entryWater" class="form-control" placeholder="0" min="0">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="entryNotes" class="form-label">Notes (optional)</label>
                            <textarea id="entryNotes" class="form-control" placeholder="Add any notes about preparation, taste, or other details..." rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn--outline" id="cancelEntry">Cancel</button>
                    <button type="submit" form="entryForm" class="btn btn--primary" id="saveEntry">Add Entry</button>
                </div>
            </div>
        </div>

        <!-- Profile Modal -->
        <div class="modal hidden" id="profileModal" role="dialog" aria-labelledby="profileModalTitle" aria-modal="true">
            <div class="modal-backdrop" aria-label="Close modal"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="profileModalTitle">Profile & Targets</h2>
                    <button class="modal-close" aria-label="Close modal">×</button>
                </div>
                <div class="modal-body">
                    <form id="profileForm">
                        <h3>Daily Nutrition Targets</h3>
                        <p class="form-description">Set your daily nutrition goals. These will be used to track your progress.</p>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="targetCalories" class="form-label">Calories</label>
                                <input type="number" id="targetCalories" class="form-control" placeholder="2000" min="500" max="5000">
                            </div>
                            <div class="form-group">
                                <label for="targetWater" class="form-label">Water (ml)</label>
                                <input type="number" id="targetWater" class="form-control" placeholder="2000" min="500" max="5000">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="targetProtein" class="form-label">Protein (g)</label>
                                <input type="number" id="targetProtein" class="form-control" placeholder="150" min="10" max="500">
                            </div>
                            <div class="form-group">
                                <label for="targetCarbs" class="form-label">Carbs (g)</label>
                                <input type="number" id="targetCarbs" class="form-control" placeholder="250" min="20" max="800">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="targetFat" class="form-label">Fat (g)</label>
                                <input type="number" id="targetFat" class="form-control" placeholder="65" min="10" max="200">
                            </div>
                            <div class="form-group">
                                <label for="targetFiber" class="form-label">Fiber (g)</label>
                                <input type="number" id="targetFiber" class="form-control" placeholder="25" min="5" max="100">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn--outline" id="cancelProfile">Cancel</button>
                    <button type="submit" form="profileForm" class="btn btn--primary" id="saveProfile">Save Settings</button>
                </div>
            </div>
        </div>

        <!-- Hidden file inputs for imports -->
        <input type="file" id="csvFileInput" accept=".csv" style="display: none;" aria-label="Select CSV file to import">
        <input type="file" id="jsonFileInput" accept=".json" style="display: none;" aria-label="Select JSON file to restore">
    </div>

    <!-- Status announcement for screen readers -->
    <div id="statusAnnouncement" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>

    <script src="app.js"></script>

<!-- Auto-fill entry date to today to avoid required-date validation blocking form submission -->
<script>
document.addEventListener('DOMContentLoaded', function(){
  try {
    var dateInput = document.getElementById('entryDate') || document.querySelector('input[type="date"]');
    if (dateInput && !dateInput.value) {
      var today = new Date().toISOString().split('T')[0];
      dateInput.value = today;
    }
  } catch(e){ console.error('date autofill error', e); }
});
</script>

</body>
</html>